/*
Version: 2025-08-18 r10.5 (merge r9 logic + r10.4 UI)
- ‡∏ô‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏¥‡∏î‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö r9 ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
- ‡∏Ñ‡∏á UI r10.4 (‡πÇ‡∏°‡∏î‡∏±‡∏• ‡∏õ‡∏∏‡πà‡∏° üìñ ‡πÅ‡∏•‡∏∞ üí°)
- ‡πÄ‡∏û‡∏¥‡πà‡∏° Media Query ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Medium Mobile (‚âà360‚Äì400px)
*/

:root{
  --purple:#6b21a8; --purple-2:#7c3aed; --ink:#111827; --line:#e5e7eb;
  --blue:#4A7BD9; --green:#4CAF50; --red:#C91C1C; --yellow:#F6D267;
  --grid:#d7d7d7;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  color:#111;
  font-size:18px;
  overflow-x:hidden;

  /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏¥‡∏î 40px ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô (‡∏à‡∏≤‡∏Å r9) */
  background-size:40px 40px;
  background-image:
    linear-gradient(to right, var(--grid) 1px, transparent 1px),
    linear-gradient(to bottom, var(--grid) 1px, transparent 1px);
}

/* Toolbar */
.toolbar{
  position:sticky;top:0;z-index:10;
  display:flex;align-items:center;gap:.6rem;
  padding:.6rem .9rem;background:var(--purple);color:#fff;

  /* ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô r9: ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏±‡∏ö‡πÅ‡∏Ñ‡∏ô‡∏ß‡∏≤‡∏™ ‡πÅ‡∏ï‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏¢‡∏≠‡∏∞ */
  flex-wrap:nowrap;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  scrollbar-width:thin;
}
.brand{font-size:.9rem}
.btn{
  border:0;border-radius:.7rem;padding:.55rem 1rem;
  background:linear-gradient(180deg,#bbd0ff,#b8c0ff);color:#000;
  cursor:pointer;font-size:1.05rem;white-space:nowrap;
}
.btn:hover{filter:brightness(.96)}
.help-btn{margin-left:auto}

/* select ‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏° (‡∏ï‡∏≤‡∏° r9) */
.toolbar select#mode{
  font-size:1.05rem;
  padding:.55rem 1rem;
  border-radius:.7rem;
  border:0;
  background:#e5e7ff;
  color:#000;
}

.row{display:flex;align-items:center;gap:.6rem;flex-wrap:wrap}
.row-top{
  padding:.7rem .9rem;border-bottom:1px solid var(--line);
  background:#fff;font-size:1.2rem;
}
.row .lbl{font-weight:700}
.row .prob{font-size:1.35rem}
.row .eq{font-size:1.35rem;margin-left:.6rem}
.row input[type=text]{font-size:1.1rem;padding:.5rem .65rem;border:1px solid var(--line);border-radius:.5rem;min-width:18rem;background:#fff;color:#111}
.row .btn-inline{background:#f3f4f6;color:#111;border:1px solid var(--line)}
.solution{margin-left:.6rem}
.check-msg{min-width:6.5rem}

/* normalize input */
.row-normalize{padding:.25rem .9rem .7rem;background:#fff;border-bottom:1px solid var(--line)}
#normalizeInput{width:100%;max-width:1100px;border:1px solid var(--line);border-radius:.5rem;padding:.5rem .65rem;font-size:1.05rem;background:#fff;color:#111}

/* Layout */
.wrap{display:flex;min-height:calc(100vh - 160px);}
.palette{width:220px;border-right:1px solid var(--line);padding:12px;background:#f9fafb}
.pal-title{font-weight:700;margin-bottom:.4rem}
.pal-item{display:flex;align-items:center;gap:.6rem;padding:.6rem;border:1px solid var(--line);border-radius:.5rem;background:#fff;margin-bottom:.6rem;cursor:grab;font-size:1.05rem}
.pal-chip{border:2px solid #222}
.chip-x2{width:24px;height:24px;background:var(--blue)}
.chip-negx2{width:24px;height:24px;background:var(--red)}
.chip-x{width:48px;height:12px;background:var(--green)}
.chip-negx{width:48px;height:12px;background:var(--red)}
.chip-one{width:18px;height:18px;background:var(--yellow)}
.chip-negone{width:18px;height:18px;background:var(--red)}
.pal-note{font-size:1rem;color:#6b7280}

.board-wrap{position:relative;flex:1;overflow:hidden}
.board{position:absolute;inset:0;transform-origin:0 0;touch-action:none}
.tile{position:absolute;border:2px solid #222;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:700;user-select:none;color:#000;touch-action:none}
.tile span{pointer-events:none}
.selected{outline:3px solid var(--purple-2)}
.sel-rect{position:absolute;border:2px dashed var(--purple-2);background:rgba(124,58,237,.1)}

/* Workspaces (‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏π‡∏ì/‡∏´‡∏≤‡∏£‡πÅ‡∏ö‡∏ö div-table) */
.ws{
  position:absolute;left:40px;top:40px;right:40px;bottom:40px;
  border:3px solid #cbd5e1;background:#f8fafc;border-radius:10px;display:none;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}
.ws .midline{position:absolute;top:20px;bottom:20px;left:50%;width:3px;background:#94a3b8}

.table2x2{
  position:absolute;left:40px;top:80px;right:40px;bottom:40px;
  border:3px solid #94a3b8;border-radius:8px;background:#fff;

  display:table; width:max(560px, 100%);
  table-layout:fixed;
}
.table2x2 .row{display:table-row}
.table2x2 .cell{display:table-cell;border:1px solid #cbd5e1;vertical-align:middle;text-align:center;font-weight:700;font-size:1.2rem;padding:.25rem}
.cell input{font-size:1.15rem;padding:.4rem .5rem;border:1px solid #cbd5e1;border-radius:.4rem;width:100%;max-width:100%;min-width:0;background:#fff;color:#111}

/* Modal base */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:40}
.modal.show{display:flex}
.card{position:relative;background:#fff;border-radius:14px;max-width:780px;width:96%;padding:16px}
.close-x{position:absolute;right:8px;top:8px;border:0;background:#eee;border-radius:50%;width:32px;height:32px;font-size:18px;cursor:pointer}
.muted{color:#6b7280}
.right{text-align:right}

/* resources list */
.res-list{margin:0;padding-left:1.1rem;line-height:1.8}
.res-list li+li{margin-top:.25rem}

/* video */
.video-wrap{position:relative;padding-top:56.25%}
.video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}

/* grid2 */
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:.8rem}
.grid2 label{display:flex;flex-direction:column;gap:.35rem}

/* üéØ Medium Mobile: 360‚Äì400px */
@media screen and (min-width: 360px) and (max-width: 400px){
  body{font-size:16px;line-height:1.5}
  button,input,select,textarea{font-size:16px;padding:12px 16px;min-height:44px;border-radius:8px}
  .toolbar{flex-wrap:wrap;gap:8px}
  .toolbar button,.toolbar select#mode,#new-question{flex:1 1 48%;min-width:140px}
  #problem{font-size:18px}
  .ws{background-size:32px 32px}
  .tile{font-size:18px;padding:8px 12px;min-width:40px;min-height:40px}
}
