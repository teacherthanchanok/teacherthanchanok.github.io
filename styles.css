:root{
  --purple:#6b21a8; --purple2:#7c3aed; --ink:#111827; --line:#e5e7eb;
  --blue:#4A7BD9; --green:#4CAF50; --red:#C91C1C; --yellow:#F6D267;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:#111;background:#fff;font-size:18px}

/* Toolbar */
.toolbar{position:sticky;top:0;z-index:10;display:flex;align-items:center;gap:.6rem;padding:.6rem .9rem;background:var(--purple);color:#fff}
.brand{font-size:1.15rem}
.btn{border:0;border-radius:.7rem;padding:.55rem 1rem;background:rgba(255,255,255,.18);color:#fff;cursor:pointer;font-size:1rem}
.btn:hover{background:rgba(255,255,255,.28)}
.spacer{width:.5rem}
select{padding:.45rem .6rem;border-radius:.5rem;border:1px solid var(--line);font-size:1rem}

.row{display:flex;align-items:center;gap:.6rem;padding:.7rem .9rem;border-bottom:1px solid var(--line);flex-wrap:wrap;font-size:1.1rem}
.row .label{font-weight:700}
.problem{font-weight:700}
.row input[type=text]{font-size:1rem;padding:.45rem .6rem;border:1px solid var(--line);border-radius:.5rem;min-width:16rem}
.btn-inline{background:#f3f4f6;color:#111;border:1px solid var(--line)}
.check{font-weight:700}
.solution{margin-left:.5rem}

/* Layout */
.wrap{display:flex;min-height:calc(100vh - 110px);}
.palette{width:220px;border-right:1px solid var(--line);padding:12px;background:#f9fafb}
.pal-title{font-weight:700;margin-bottom:.4rem}
.pal-item{display:flex;align-items:center;gap:.6rem;padding:.55rem;border:1px solid var(--line);border-radius:.5rem;background:#fff;margin-bottom:.55rem;cursor:grab;font-size:1rem}
.pal-chip{width:24px;height:24px;border:2px solid #222;border-radius:4px}
.chip-x2{background:var(--blue)}
.chip-x{background:var(--green);width:48px;height:12px}
.chip-1{background:var(--yellow);width:18px;height:18px}
.chip-neg{background:var(--red)}
.chip-neg-x{background:var(--red);width:48px;height:12px}
.chip-neg-1{background:var(--red);width:18px;height:18px}
.pal-hint{font-size:.95rem;color:#6b7280}

.board-wrap{position:relative;flex:1;overflow:hidden;background:#fff}
.board{position:absolute;inset:0;transform-origin:0 0; touch-action:none;}
.grid{position:absolute;inset:0;background-image:
  linear-gradient(to right,#eee 1px,transparent 1px),
  linear-gradient(to bottom,#eee 1px,transparent 1px);
background-size:30px 30px}
.tile{position:absolute;border:2px solid #222;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:700;user-select:none;color:#000; touch-action:none;}
.tile span{pointer-events:none}
.selected{outline:3px solid var(--purple2)}
.sel-rect{position:absolute;border:2px dashed var(--purple2);background:rgba(124,58,237,.1)}

/* Workspaces */
.ws{position:absolute;left:40px;top:40px;right:40px;bottom:40px;border:3px solid #cbd5e1;background:#f8fafc;border-radius:10px;display:none}
.ws .midline{position:absolute;top:20px;bottom:20px;left:50%;width:3px;background:#94a3b8}
.table2x2{position:absolute;left:40px;top:80px;right:40px;bottom:40px;border:3px solid #94a3b8;border-radius:8px;display:grid;grid-template-columns:180px 1fr;grid-template-rows:160px 1fr;background:#fff}
.cell{border:1px solid #cbd5e1;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:1.1rem}
.cell input{font-size:1.1rem;padding:.4rem .5rem;border:1px solid #cbd5e1;border-radius:.4rem;min-width:120px; touch-action:auto;}

/* Help */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:40}
.card{position:relative;background:#fff;border-radius:14px;max-width:920px;width:96%;padding:16px}
.close-x{position:absolute;right:8px;top:8px;background:#ef4444;border:none;color:#fff;border-radius:999px;width:34px;height:34px;cursor:pointer;font-weight:800}
.h-title{font-weight:800;margin-bottom:.4rem}
.h-list{margin:.3rem 1rem;font-size:1rem}
.video-wrap{position:relative;padding-top:56.25%;margin:.5rem 0}
.video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
.credit{text-align:center;margin-top:.5rem}
.contact{display:flex;justify-content:center;margin-top:.6rem}
.contact-btn{background:linear-gradient(180deg,#bbd0ff,#b8c0ff);color:#111;border-radius:.7rem;padding:.55rem 1rem;text-decoration:none}

/* mobile layout: ย้าย palette ลงล่าง */
@media (max-width: 900px){
  .wrap{flex-direction:column}
  .palette{
    width:100%;
    display:grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap:.5rem;
    padding:10px 12px;
    border-right:0;border-top:1px solid var(--line);
  }
  .pal-item{margin-bottom:0}
  .board-wrap{min-height:62vh}
}

/* ให้ input ใน workspace พิมพ์ได้บนมือถือ */
.ws input, .ws select, .ws textarea{
  touch-action:auto; pointer-events:auto; position:relative; z-index:5;
}
